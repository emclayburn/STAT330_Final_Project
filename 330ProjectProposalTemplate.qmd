---
title: "Stat 330 Final Project Proposal"
authors: Jose De Leon and Ethan Clayburn
format: 
  pdf:
    embed-resources: true 
---

```{=html}
<style type="text/css">
h1.title {
  font-size: 40px;
  text-align: center;
}
</style>
```

```{r setup, include=FALSE}
library(tidyverse)
library(readxl)
library(ggplot2)
library(car)
```

# 1 Group Members

The group members are Jose De Leon and Ethan Clayburn

# 2 Data Set

We plan on using a baseball dataset that shows MLB team performance since 1998, when the last expansion teams were added.

```{r}
baseball <- read_csv("Teams.csv")
baseball <- baseball |>
  select(yearID, teamID, Rank, W, H, R, RA, ERA, E, BPF, attendance, L) |>
  filter(yearID >= 1998 & yearID != 2020) |>
  mutate(
    WinPct = W / (W + L)
  ) |>
  select(yearID:W, WinPct, everything(), -L)

View(baseball)

baseball_simplified <- baseball |>
  select(yearID, Rank, W, WinPct, H, R, RA, ERA, E, BPF, attendance)
```

# 3 Potential Questions of Interest

Does the stadium atmosphere (BPF, Attendance) affect win percentage? Where a team plays and how popular they are might affect how a team plays on the field. 
Does the defense affect win percentage more than offense? There is a common phrase of defense win championships, it defense really that important?

# 4 Exploratory Data Analysis

DELETE THIS: Conduct EDA and provide **at least 3** figures or statistics highlighting features or between variable relationships within the data that are relevant to the questions of interest you provided earlier in the proposal. **You should explain what you found interesting or noteworthy about each of 3 included elements.**

```{r}
ggplot(data = baseball, aes(x=H + R, y=WinPct, color = teamID)) +
  geom_point()

```
It's interesting to see that the more hits and runs you have, the higher your win percentage. The correlation is very strong when ploting the points. 

```{r}
ggplot(baseball, aes(x=R - RA, y=WinPct, color = teamID)) +
  geom_point()
```
The run differential has a very strong correlation. The more hits you have compared to your opponents, the higher your win percentage is.

```{r}

ggplot(data = baseball, aes(x = attendance, y = WinPct, color = BPF)) +
  geom_point(alpha = 0.7) +
  labs(
    title = "Winning Percentage by Attendance, Colored by Batting Park Factor",
    x = "Attendance (Raw)",
    y = "Winning Percentage",
    color = "BPF"
  )

```
This graph is an interesting one to looks it. There is a positive correlation between total attendence and winning percentage, but the ball park doesn't really factor in too much.

# 5 Preliminary Model Fit

Our dependent variable is the teams win percentage and out explanatory variable is the hits a team has.

$WinPct_i$ = $\beta\_0$ + $\beta\_1$ \* $RA_i$ + $\beta\_2$ \* $ERA_i$ + $\beta\_3$ \* $E_i$ + $\epsilon$

Someone would be interested in this relationship because fielding and pitching is a big part of baseball. You would want to see if it is the fielders in general or the pitchers that affect the winning percentage the most.

```{r}
lm.fit = lm(WinPct~ERA+E, data = baseball_simplified)
```

DELETE THIS: Assess whether the regression assumptions are satisfied **and provide interpretation for the estimated model coefficients and associated uncertainty estimates.** You are welcome to use as many or as few code blocks as you wish in this section, but make sure that your analysis is easy to follow.

```{r}
#E

model_data <- fortify(lm.fit)
ggplot(model_data, aes(x = .fitted, y = .resid)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
  labs(
    title = "Residuals vs. Fitted Values",
    x = "Fitted Values",
    y = "Residuals"
  )
#L
avPlots(lm.fit)
summary(lm.fit)

#Multicollinearity

vif(lm.fit)

#N
plot(lm.fit, which = 2)

```

```{r}
#influential points
plot(lm.fit, which = 5)
```
